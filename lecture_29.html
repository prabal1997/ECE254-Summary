<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>lecture_29</title></head><body><h2>Linux Scheduling (Commercial)</h2><br><span style="font-weight: bold;">Two types of thread-based schedulers:</span><br><ul><li><span style="font-weight: bold;">Linux Real-time Scheduler</span>: schedules <span style="font-style: italic;">real-time</span> and <span style="font-style: italic;">normal</span> threads.</li><ul><li><span style="font-style: italic;">normal </span>threads subject to normal scheduler routine.</li></ul><li><span style="font-weight: bold;">Linux Non-Real-time Scheduler</span>: schedules only <span style="font-style: italic;">normal</span> threads</li></ul><span style="font-weight: bold;">Linux Real-time Scheduler</span><br>Divides work into 3 queues:<br><ul style="font-family: Courier New,Courier,monospace;"><li>SCHED_FIFO: <span style="font-family: Times New Roman,Times,serif;">First-in, first-out real-time threads/tasks.</span></li><ul><li><span style="font-family: Times New Roman,Times,serif;">Scheduled as follows:</span></li><ul><li><span style="font-family: Times New Roman,Times,serif;">FIFO thread gets interrupted only if:</span></li><ul><li><span style="font-family: Times New Roman,Times,serif;">Higher priority FIFO thread is ready.</span></li><ul><li><span style="font-family: Times New Roman,Times,serif;">If multiple high priority threads of same priority read, choose one who waited <span style="font-style: italic;">longer.</span><br></span></li></ul><li><span style="font-family: Times New Roman,Times,serif;">FIFO thread gets blocked (e.g on I/O).</span></li><li><span style="font-family: Times New Roman,Times,serif;">FIFO yields with <span style="font-family: Courier New,Courier,monospace;">sched_yield</span>.</span></li></ul><li><span style="font-family: Times New Roman,Times,serif;">FIFO thread is interrupted, it is placed in the ready queue.</span></li></ul></ul><li>SCHED_RR: <span style="font-family: Times New Roman,Times,serif;">Round-robin Real-time threads/tasks.</span></li><ul><li><span style="font-family: Times New Roman,Times,serif;">Same as FIFO scheduling, except implementation includes time-slices.<br></span></li></ul><li>SCHED_OTHER: <span style="font-family: Times New Roman,Times,serif;">Non-real-time threads.</span></li><ul><li><span style="font-family: Times New Roman,Times,serif;">A non-real time thread executes <span style="font-style: italic;">only </span>if no <span style="font-style: italic;">Round-robin</span> or <span style="font-style: italic;">FIFO</span> threads are ready.</span></li></ul></ul><span style="font-weight: bold;">Linux Non-Real Time Scheduler:<br></span><ul><li><span style="font-weight: bold;">Traditional:</span></li><ul><li>O(n) algortihm</li><li>Bad for <span style="font-style: italic;">multi-processing</span> because:</li><ul><li>Single&nbsp; queue</li><li>Single <span style="font-style: italic;">mutex</span> access to run queue.</li><li>No <span style="font-style: italic;">pre-emption</span><span style="font-weight: bold;">.<br></span></li></ul></ul><li><span style="font-weight: bold;">O(1) Algorithm:</span></li><ul><li>Guarantees <span style="font-style: italic;">O(1)</span> runtime.</li><li>Implements a queue for 140 different priorities with <span style="font-style: italic;">round-robin:</span></li><ul><li><span style="font-style: italic;">0-99:</span> Real-time<span style="font-style: italic;">; 100-139:</span> Normal</li><li>A 'queue' is technically two queues:</li><ul><li style="font-weight: bold;">Active Queue:</li><ul><li style="font-weight: bold;"><span style="font-weight: normal;">Queue of ready, unserved threads.</span></li><li>Pre-empted tasks go back to <span style="font-style: italic;">active queue</span></li><li style="font-weight: bold;"><span style="font-weight: normal;"><span style="font-style: italic;">All </span>scheduling happens here only.</span></li><li style="font-weight: bold;"><span style="font-weight: normal;">When <span style="font-style: italic;">active queue</span> empty, <span style="font-style: italic;">active</span>, <span style="font-style: italic;">expired queue</span> exchange spots.<br></span></li></ul><li style="font-weight: bold;">Expired Queue: <span style="font-weight: normal;">Queue of ready, unserved threads</span></li></ul></ul><li>Implements bitmap to indicate empty queues.</li></ul><li><span style="font-weight: bold;">CFS (Complete Fair Schedule):</span></li><ul><li>Runs in <span style="font-style: italic;">O(ln(n))</span> time</li><ul><li><span style="font-style: italic;">Caching</span> used to improve performance.</li></ul><li>Uses <span style="font-style: italic;">red-black self-balancing </span>trees for <span style="font-style: italic;">ready-queue.</span></li><ul><li>Threads sorted as per <span style="font-style: italic;">virtual-</span>CPU running time used</li><ul><li><span style="font-weight: bold;">Time Recorded:</span></li></ul><ul><ul><li><span style="font-style: italic;">Higher</span><span style="font-weight: bold;"> </span>nice value means over-recorded CPU-runtime</li><li><span style="font-style: italic;">Lower </span>nice value means under-recorded CPU-runtime.</li></ul><li><span style="font-weight: bold;">History Decay:</span></li><ul><li><span style="font-style: italic;">Higher</span> priority means faster recorded-runtime decay</li><li><span style="font-style: italic;">Lower</span> priority means slower recorded-runtime decay<span style="font-weight: bold;"><br></span></li></ul></ul><li><span style="font-style: italic;">Round-robin-ing, Time-slice</span> vary in length to meet <span style="font-style: italic;">Target Latency.</span></li><ul><li><span style="font-weight: bold;">Target Latency: </span>total time to serve all ready processes.<span style="font-style: italic;"><br></span></li></ul></ul></ul><ul><ul><li><span style="font-style: italic;"><span style="font-style: italic;">Blocked </span></span>tasks removed from <span style="font-style: italic;">ready-queue</span></li><li><span style="font-style: italic;">Pre-empted </span>tasks inserted again<span style="font-style: italic;"> </span>with updated CPU-runtime</li><li>Trees periodically balanced.</li></ul><li><span style="font-style: italic;">I/O Bound </span>threads highly priortized to increase <span style="font-style: italic;">responsiveness</span></li><li><span style="font-style: italic;"><span style="font-weight: bold;">Group Scheduling:</span></span></li><ul><li>Related threads spawning each other are part of a <span style="font-style: italic;">group</span></li><li><span style="font-style: italic;"><span style="font-style: italic;">Multiple </span></span>groups exist on system - groups are treated equally</li><ul><li><span style="font-style: italic;">Groups </span>might have different number of threads in them</li><li>Within <span style="font-style: italic;">groups, </span>threads have a fair competition</li></ul></ul></ul></ul><big><big><span style="font-weight: bold;">NOTE: you STILL NEED to complete the section about SMP</span></big></big></body></html>